const fetch = require("node-fetch");
var whileF = 0;

class Monitor {
    constructor(prod) {
        if(!prod.array) throw new TypeError("HATA: Bir link belirtilmesi gerekir!")
        if(typeof prod.array !== "object") throw new TypeError("HATA: Bir array dizesinde olmalıdır!")

        if(!prod.duration) throw new TypeError("HATA: Bir zaman girilmesi gerekir!")
        if(typeof prod.duration !== "number") throw new TypeError("HATA: Bir number dizesinde olmalıdır!")

        this.links = prod.array;
        this.time = prod.duration;
    }

    start() {
        console.log("BAŞARILI: linkler tek tek ziyaret etmeye başlanıyor!") 

        setInterval(() => {
            if(whileF === 1) return;

            this.links.forEach(async(element) => {
                 fetch(element)
            });
        }, this.time);
    }

    end() {
        console.log("BAŞARILI: link ziyaret edimi sonlandırıldı!")
        whileF += 1;
    }

}

module.exports = Monitor;